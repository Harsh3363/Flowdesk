{"version":3,"file":"tambo-v1-provider.js","sourceRoot":"","sources":["../../../src/v1/providers/tambo-v1-provider.tsx"],"names":[],"mappings":";AAAA,YAAY,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6Gb,0CA+CC;AA1JD;;;;;;;;;;GAUG;AAEH,+CAAgE;AAChE,uDAAyE;AACzE,iFAG+C;AAC/C,qFAGiD;AAEjD,uEAAkE;AA6ClE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAsCG;AACH,SAAgB,eAAe,CAAC,EAC9B,MAAM,EACN,QAAQ,EACR,WAAW,EACX,SAAS,EACT,UAAU,EACV,KAAK,EACL,UAAU,EACV,sBAAsB,EACtB,WAAW,EACX,QAAQ,GACgC;IACxC,wDAAwD;IACxD,mEAAmE;IACnE,MAAM,CAAC,kBAAkB,CAAC,GAAG,IAAA,gBAAQ,EACnC,GAAG,EAAE,CACH,IAAI,yBAAW,CAAC;QACd,cAAc,EAAE;YACd,OAAO,EAAE;gBACP,SAAS,EAAE,IAAI;gBACf,KAAK,EAAE,CAAC;aACT;SACF;KACF,CAAC,CACL,CAAC;IAEF,MAAM,MAAM,GAAG,WAAW,IAAI,kBAAkB,CAAC;IAEjD,OAAO,CACL,8BAAC,iCAAmB,IAAC,MAAM,EAAE,MAAM;QACjC,8BAAC,2CAAmB,IAClB,MAAM,EAAE,MAAM,EACd,QAAQ,EAAE,QAAQ,EAClB,WAAW,EAAE,WAAW,EACxB,SAAS,EAAE,SAAS;YAEpB,8BAAC,+CAAqB,IACpB,UAAU,EAAE,UAAU,EACtB,KAAK,EAAE,KAAK,EACZ,UAAU,EAAE,UAAU,EACtB,sBAAsB,EAAE,sBAAsB;gBAE9C,8BAAC,+CAAqB,QAAE,QAAQ,CAAyB,CACnC,CACJ,CACF,CACvB,CAAC;AACJ,CAAC","sourcesContent":["\"use client\";\n\n/**\n * TamboV1Provider - Main Provider for v1 API\n *\n * Composes the necessary providers for the v1 SDK:\n * - TamboClientProvider: API client and authentication\n * - TamboRegistryProvider: Component and tool registration\n * - TamboV1StreamProvider: Streaming state management\n *\n * This provider should wrap your entire application or the portion\n * that needs access to Tambo v1 functionality.\n */\n\nimport React, { type PropsWithChildren, useState } from \"react\";\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport {\n  TamboClientProvider,\n  type TamboClientProviderProps,\n} from \"../../providers/tambo-client-provider\";\nimport {\n  TamboRegistryProvider,\n  type TamboRegistryProviderProps,\n} from \"../../providers/tambo-registry-provider\";\nimport type { McpServerInfo } from \"../../model/mcp-server-info\";\nimport { TamboV1StreamProvider } from \"./tambo-v1-stream-context\";\n\n/**\n * Props for TamboV1Provider\n */\nexport interface TamboV1ProviderProps extends Pick<\n  TamboClientProviderProps,\n  \"apiKey\" | \"tamboUrl\" | \"environment\" | \"userToken\"\n> {\n  /**\n   * Components to register with the registry.\n   * These will be available for the AI to use in responses.\n   */\n  components?: TamboRegistryProviderProps[\"components\"];\n\n  /**\n   * Tools to register with the registry.\n   * These will be executed client-side when requested by the AI.\n   */\n  tools?: TamboRegistryProviderProps[\"tools\"];\n\n  /**\n   * MCP servers to register with the registry.\n   * These provide additional tools and resources from MCP-compatible servers.\n   */\n  mcpServers?: (McpServerInfo | string)[];\n\n  /**\n   * Callback function called when an unregistered tool is called.\n   * If not provided, an error will be thrown for unknown tools.\n   */\n  onCallUnregisteredTool?: TamboRegistryProviderProps[\"onCallUnregisteredTool\"];\n\n  /**\n   * Optional custom QueryClient instance.\n   * If not provided, a default client will be created.\n   */\n  queryClient?: QueryClient;\n\n  /**\n   * Children components\n   */\n  children: React.ReactNode;\n}\n\n/**\n * Main provider for the Tambo v1 SDK.\n *\n * Composes TamboClientProvider, TamboRegistryProvider, and TamboV1StreamProvider\n * to provide a complete context for building AI-powered applications.\n *\n * Threads are managed dynamically through useTamboV1() hook functions:\n * - startNewThread() - Begin a new conversation\n * - switchThread(threadId) - Switch to an existing thread\n * - initThread(threadId) - Initialize a thread for receiving events\n * @param props - Provider configuration\n * @param props.apiKey - Tambo API key for authentication\n * @param props.tamboUrl - Optional custom Tambo API URL\n * @param props.environment - Optional environment configuration\n * @param props.userToken - Optional OAuth token for user authentication\n * @param props.components - Components to register with the AI\n * @param props.tools - Tools to register for client-side execution\n * @param props.mcpServers - MCP servers to register for additional tools/resources\n * @param props.onCallUnregisteredTool - Callback for handling unknown tool calls\n * @param props.queryClient - Optional custom React Query client\n * @param props.children - Child components\n * @returns Provider component tree\n * @example\n * ```tsx\n * import { TamboV1Provider } from '@tambo-ai/react/v1';\n *\n * function App() {\n *   return (\n *     <TamboV1Provider\n *       apiKey={process.env.NEXT_PUBLIC_TAMBO_API_KEY!}\n *       components={[WeatherCard, StockChart]}\n *       tools={[searchTool, calculatorTool]}\n *     >\n *       <ChatInterface />\n *     </TamboV1Provider>\n *   );\n * }\n * ```\n */\nexport function TamboV1Provider({\n  apiKey,\n  tamboUrl,\n  environment,\n  userToken,\n  components,\n  tools,\n  mcpServers,\n  onCallUnregisteredTool,\n  queryClient,\n  children,\n}: PropsWithChildren<TamboV1ProviderProps>) {\n  // Create a stable default QueryClient if none provided.\n  // Using useState to avoid SSR issues with module-level singletons.\n  const [defaultQueryClient] = useState(\n    () =>\n      new QueryClient({\n        defaultOptions: {\n          queries: {\n            staleTime: 1000,\n            retry: 1,\n          },\n        },\n      }),\n  );\n\n  const client = queryClient ?? defaultQueryClient;\n\n  return (\n    <QueryClientProvider client={client}>\n      <TamboClientProvider\n        apiKey={apiKey}\n        tamboUrl={tamboUrl}\n        environment={environment}\n        userToken={userToken}\n      >\n        <TamboRegistryProvider\n          components={components}\n          tools={tools}\n          mcpServers={mcpServers}\n          onCallUnregisteredTool={onCallUnregisteredTool}\n        >\n          <TamboV1StreamProvider>{children}</TamboV1StreamProvider>\n        </TamboRegistryProvider>\n      </TamboClientProvider>\n    </QueryClientProvider>\n  );\n}\n"]}